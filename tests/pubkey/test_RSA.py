from cryptolib.pubkey import RSA
import pytest


test_data =  [
    (
        0xb31bdcf5cf367dea0028a9388d44a4905921bbd1b719fe6cbeaecfa87ec81b88247eacc601f15d051e66db408e6481ebc50f6cf9e0cf294f5702df360930626145950e39f928ba129ff51244d03180c9ac26f2631e81229fe9f9fe839bc2021d6943a8d7f9dc058aa838fcafd455953574c9aac9ad619eb0b84e58b09da776d8525e367345de03e30d169afcc83d08c37bfcebd7a9d15b4e2d8beebd35cc4213e8947b788e71bf6f444541563dc03ab876f471e0b7a7b6c09b241a73fc2da5eacd38ecd1d53d6bb08087bc8100d92ced616241036fc2c50eda4a8414c86052424b79f9989b57356e6f87295b2fd642af405f6f4b371c695f70235b9eb2c83f1f,
        0x10001,
        0x1915eef5b2a7042db10600e57dcbbe6cc53f174a4125efdf953970b63dc3932f9744f2b7ecefbc428a4687b0dc00b1bdaee50133624c4191ee32e5c670b509226c977add9dcb197ca050b7d5517f8d75319a66da811c3f183cb219f69eeb2656ae369ec0592b7acf37ce7b7db8f49fa8540a26d4866724cdc5929b9369115a70a7cc99d0fb62470fa814ae31dbc3fe9c7f44ef818e0044c8b40c86779cc4a6059c3c35895c98b4cfaa0084c69590c63e694a2c00cb11c885119298b35d604961a4cc1709c155f5a4826182797a15fd23fb97785ad14ae8ebfc141b57fb264b4dfd9edb8bc68ea649f4fab3f48fd2b5d884a1e99d5489a441737d08ac1268fbb1,
        0x525341207465737420636173652031,
        0x301cbdb3d61bbb0cda804c62bbc72013c582ebd4bd0e04aefa0965f828d4a3934ec64bb3b6e0ab859f5566d9e43394b93d766ed1d3c48d5c9adff57f946d472ba08e591d8c0b99874bde3be76ef7b1972e4e142b3d5f9589602966198a44892d10fee7b403f29850e1ef129e3d76c3a76f5310dcc6ba7063982c32a8814187c78bb5a87c03bd7418eeea33b3e707bf3893c8ceadb0dc8997dcea6ce2683f0d8cafa614b3b59de8dc71460ef09a2ddaecc436d409de0cea7ae9ea2ff9dac6d00dd4e5422cb2d45db1b51bc36bb7e3ebb48b81a3ae6da5d92fdd77734f31fdd3dbf363fcb036846795839c0b772c00c9dea8b3fa2e24488bf9b52f45114b868f8a,
    ),
    (
        0x6cf55c6e69bdee97feae1272bea43211be24a591b911a4139dbc5f39b2ebc5fa3c266f0d3d563609be158eba9b06de126f911a8c8260b93d839c86ac59dbd90c1b544b8fc793fa0e0b59403b9f96276bb46690fac9e2bcd255cd6cfc6a29014b0054d95ea671ca1887c256539a08ac9b2b590e2e349b7564026e175a6c051b0c834cb3dbf12f9b0783fdab7afc63f14f8185e1c2382d14ed2365c23841c3c24a1a2064f2a1eeb6f89146656470664005925ec6e583db8998f86978f64bca44bf1fc63ffe35b54b1960ab3bfe6689a29d04d51038c31733124d4237c9c8caaa23a38d3c46f3198639a5e183aeeac2798ec3e9ade262b8ee5ef5dbc9cbf142f6bb,
        0x10001,
        0x3570e2b50508334e398c07606041088dcb450e303b257be46329514b6b8658c4335c667b87ea10f716545c7d0a2c841f66b934dc55d63b0500d874f573dd70c78f5ff8efbc63c7f1bb7f3b1203641251b159dd2224832139c8fbc8c8c508f7a961b03c2d4055ef59b8bc88bad88208a6d2cc0b387e75014edc22433206693aaa702d9d6bf5e5e3c636e47f6f205e89d4c1ca3d5d3fbc772b9133aa7f98d9da00f3d2e7496d834eea028b4eab21e2ad331b8bb8f9bf932b65443f077771b09aa6f7c0cce7db8e26f00de211a5d67fd935b7424cbf45999121abbeac7021512f5bcc7f393e17197a2990deb61219d94f6a6627a8da8151f26a6c86b26811f1e901,
        0x525341207465737420636173652032,
        0x24740bb94adbc855491cecfe9b8fc7a0b5147c6f6906e6f25844d0faf300c0319d2b2467778b27487daa72650c453f302f82137af84dbc14f6f4f9668ea68a0db3ce43ed7cd5b83b0be8d792c7ea7c5121098d887dd3c009cb7b6d740e88bfe4d72a73958b234ae39b15a1b300c3f7b922bc7b13fe5490d98f7fc233bd4925912136cc04982465822a3645a02883f46b28585d06c0734c95f05ed15f3cd8acc82740a5b84b6840f85f2c96899c508e8ada16469ba97f36362f0ed5db0b5b496bb3389d8a1f5b6619d0d02f9426639ae02a6d17842aeee5b5c99d62839caa7156a733368df3e2ef501fa9d576cc95e5631b55a292facb46da9002581a412f6877,
    ),
    (
        0x707267c795fc854021504c6f459194f4712c5c019ede6123e132f1d6ead815830c85d2915f50f2dd9a491afe066484056594275b5d320a0777916c84503159b916099f898ce401fe31e16d7b5e0aec9660df328f6a264864d945dd6bf130f71128425353c1f8d71360850a9dc8002f679cd452b167367466b5f6f2a9314dce5dd104ba9f8b733ea090fa36a2912a44d4c7f60f162cd7c5b218213a658b489534f76fa9906e51efc05f68dfc9d1ece84d038954f41d3d3e49dea7717228f35ff4ff2cc048295cfc5f3fce3139405ab1a0a90762a675e0197123ef49f8699e565b531c36f91e0415e9837c57648835fb73fa43abb56aabd99668cf1da739f7d4eb,
        0x10001,
        0x4a0616699e44315829561a2b3a29ff5bf7d0d2f4c227f4dcd0d85fba32b97357e4fb87c5e97079a1067b4fc8a05eb546743b56b95f9d9c5a940ce8da258c875b3fb5b00fb5ef379ca62b978e1a37a8cdca11c4d0027a1738448c289a7199e15bab1c168cd1e9c5745d1ad8054c6f4ac5b3c95672b0d67944504fb4294b6ac409bfc6157dd86696423364a1d40eac25a2185ea313f34354a9287ac64865acd8189d9dd8748a44d8577d29f050add789c94feaeeb8882bbb364d7071086bc318fc66f97d5644884f13b9a06b4dde2f614716459a26d8b152b0be1b585409bf79fbc53acc822cd511e124577dc1ec3de38b733bd79f10bb12ded232ab5871116849,
        0x525341207465737420636173652033,
        0x4b0e59212236472f828558ebe63a472059181d8b1445ec7c84eea80c3432d73c891fae26b2debeb4e1c89738ffe1e4c2febf4f3910e82f04f84e0a6f748f8a898d3144057b735ddadb9ecbe1113356632736efbb88ba2d9959a6b53f751188121a38c44dc5ba15735a7cb70958f884c79ac67fd511189f8c4de3900dcfed9bf59758a5760e2a3d69d8e13247e1e103a8e5ef9d43cce3b2c801995eaedee53b2a01ec5adf7c113aa22b19e4aaeb69b676896f7200369f7692b967583656794599a10569f593b38b91bd2782cc3775899f19f8bc845a31a86421d048e91809b5d444d212093ba239c0ee0e6677102fe35fe709e64a6be35730a621aa4ffdab5e7a,
    ),
    (
        0xc91d69f458eb2122dbdd41e977424d6160eadb026df0d70b0b1d4c9591970e0dc16d51763429f44c0d4cea81b63dcbc85658d293391f783def297fa2fe24ffdb1e36b56f8fa55c44ef272fdf38d88451823c1791edfc77a278519f3679e257a87351289449664d55ffb1baec372ea8795688af25313e148d1bc2d21e94f84d7dbe9a74cbb64515d8966c4b3a5fd91edf52dddb78f5af8b701f802fa54fc414c958e705e1f9ad7f4351850904a475a2c7e36ea5ad0e6f1a0288a1fd3367c1d1fd04174149cf8441afa3cdd9b6a3da80e609759dc10daecaefeca221d189bbf98bb4c79ee0d266ea965859fa17635b3f6f41dbd2e4e2bb88c72b98f786f6359795,
        0x10001,
        0x445a4ce2913e08db1222d6fe045c7274403e5205375c7d99f14319fe53a7254da38a05ffc8a6e1b2df6a5ee18b10e1abcb3d11049c8b879075328380e023af19c7e10c35487b092b1ca512ee2921dd86de5e921c34e873b8b26ffb4ec68a1904d57ca5f0102a46ea8da6d842e45665482812f884098271f5ab93c15a478344c276b5ae1eb9d7b32aa65660f7eaf2e17ff12a678ca0d46802697094cbb9aa005eded8c8c768b5686fbe7504f1e8b07f76409213f0a551ed33db0179bd4187e5ea1fb891a8d4e2aa7891aa7028c7ec2485ae0d27675fb961ce63cc5264d2f4b09844042a0acc01665da94a9b2010023c5b13bbd9474ecda877d67f021bc0f6ea59,
        0x525341207465737420636173652034, 
        0x542edc3cec792bd5a8a4c600de9e81a2d12b4c2ec64d769d35c9a79fce45269d1ef93e306b2ec9988cc46fdd025af5c5dab6adc074fba28ea8c739e1060329830a1c031d09a5d6e23eb8b7f3c3953dec566ff2e6dcb5ca588b7f1a0eb34714c8bf259358434d896f338124633b389d7cc2a2b2efa73fe302397aca8c5da3f4a402244df15c2e91e2ad22e5076ed421536fa67338027a19d1a7ff527f9e3cbadd8fede9a4a79c64b166853884a3ee5a00433a7a60a97eaaad0a1148e8a08f9305d40864910c825be39fe08203668ea8fb2850628186337fd4bb63382db177b206e00eb3fdfa4fdbb95727abdb30bb865d9a26abd620440afe5aa21a4314e4f196,
    ),
    (
        0x7ce4479155620bdec479a8977eb8ea6ec8d151f0567c53b4606f4a92174434a8f3537c3cbe69d91724c96290aee5ba16784c8a7932b2099ba87203db435b00c70b6146ebbc2ce2817b64958fdcb2597a6f30a92b5284128683560ea8e8c7f54643ad9d5b9f8043967bf0a9e59c3205160bb7c8c43abfd75a0a4d69b943b1dbf906015362b17bef4c8951f172839b9e2fef60ff41f43090fadaef95c16cedb5bb5d70d96e2a01b7e452bcefe1af0f387ff3b29d8873bcf6f79c8c24649207d23d6440f08237e78dff82308fcc5e80ccf70835dd6af44801c79a9165ca38849e3c1666610aa5170a538687ad582d242bb1c6ed3b7d6b7aa19e7793b3be132ea83d,
        0x10001,
        0x3fe5267c433b93291849c9a8200c08dc3edf60555e59e31520552fc88820bbf447f0c959e66d0ec4d96c32822508a0e8c80918bb22e59526cec9ee112a678f8145e031c17f175396bd035bc52b3b0fae24deb75dd3ac8031d3559ed069af8b5bb45a496c4bb0fa632deb957044360f06155ea457485b4798e8366cc57ccdace50663e13f8d61898cb78e9820e4daf45ebbdd62ac1e9ccafcc324f51fdf22ac454e02fbbe7e0ace6dad2b75109732b7f289a482197453870cb624b3ebbdd01af33b60bbc9c16d495444c457a4b63c69f2d553168a4c183656fc19d7f48fc3a29e3d70ded469f3d237190848aabee2ea47fd05f1c8b24746e55800daac95e4e51d, 
        0x525341207465737420636173652035, 
        0x1f1c8b7fa918eea4c006022adc2e4521160fe65a1450209fbb8c789594515f26458f2688309415deb1e5a0b9de0fb33ec7ac5ee416aa8c4faeaaf51def7a6baf892d7a9bdb8ba38234d8be1a4cd847b1da01d53c3cd316c990dc49280c350af1f4ecca91eb7893cf6f0ab468dbed28fe11454f997d782a81c130698e3bca28cf80306e38cbb47890b0ace9242bf7ab2629b03a28394f123d3f4d76ed9aa7a40751d19f3545e9f09c1c8a3b73a9364e7bd3d28bb7df9b585e46c9e540b46f25f253ce936ed38d80a9c28501726a2d1275c9730856562f1fbf57e79ef21b442a5eea7f5f91f97294095510ef0f2a68234e76f39a93e9b15b7081e00348b602a0cd,
    ),
 ]


@pytest.mark.parametrize('n, e, d, plain, cipher', test_data)
def test_RSA(n, e, d, plain, cipher):
    rsa = RSA.construct(n, e, d=d)
    _cipher = rsa.encrypt(plain)
    _plain = rsa.decrypt(_cipher)
    assert _cipher == cipher
    assert _plain == plain
